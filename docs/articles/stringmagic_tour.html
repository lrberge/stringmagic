<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`stringmagic`: A quick tour • fixest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`stringmagic`: A quick tour">
<meta property="og:description" content="stringmagic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fixest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stringmagic_tour.html">`stringmagic`: A quick tour</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Guides</li>
    <li>
      <a href="../articles/smagic_walkthrough.html">`smagic`: Magical string interpolation</a>
    </li>
    <li>
      <a href="../articles/string_tools.html">String tools: magic edition</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lrberge/stringmagic/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>stringmagic</code>: A quick tour</h1>
                        <h4 data-toc-skip class="author">Laurent R.
Bergé</h4>
            
            <h4 data-toc-skip class="date">2023-06-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lrberge/stringmagic/blob/HEAD/vignettes/stringmagic_tour.rmd" class="external-link"><code>vignettes/stringmagic_tour.rmd</code></a></small>
      <div class="hidden name"><code>stringmagic_tour.rmd</code></div>

    </div>

    
    
<p>Text is everywhere in data science, so better be equipped with the
right tools! The package <code>stringmagic</code> offers several
functions to empower and streamline low level operations on text
data.</p>
<p>This short vignette provides a quick tour of <code>stringmagic</code>
tools and links to the associated documentations.</p>
<div class="section level2">
<h2 id="string-interpolation-with-smagic">String interpolation with <code>smagic</code><a class="anchor" aria-label="anchor" href="#string-interpolation-with-smagic"></a>
</h2>
<p>The function <code>smagic</code> is the <em>raison d’être</em> of
this package. It offers <em>magical</em> string interpolation.</p>
<p>For the record, string interpolation is a feature common to many
programming languages, it is about inserting values from a variable
directly in a character string. For example if <code>x = "Sam"</code>,
then <code>"Hi {x}!"</code> becomes “Hi Sam!”.</p>
<p><code>smagic</code> enables to perform <em>any arbitrary
operation</em> to the variables we interpolate. This opens the door to
many possibilities, and makes the composition of complex character
strings a piece of cake. By default over 50 basic operations are
available, but the user can seamlessly add any she wants. It supports
nesting, has advanced support for pluralization, and much more.</p>
<p>Like any powerful tool (looking at you <em>regular expressions</em>),
it has its own syntax, its own commands, and will require practice
before mastering it. To minimize learning costs, great effort has been
spent on error handling, with error messages hopefully explaining where
the problems are and how to solve them. So fear not trying out
stuff!</p>
<p>If interested, here is the <a href="https://lrberge.github.io/stringmagic/articles/smagic_walkthrough.html" class="external-link">documentation</a>
and next comes an example.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Here’s a set of stuff I do with my kids and my associated
self-assessed sikll level:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">skills</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"managing to lose at chance-based board games: 8/10"</span>, </span>
<span>           <span class="st">"making them clean their mess: 3/10"</span>, </span>
<span>           <span class="st">"being OK with cooking stuff they don't eat: 9/10"</span>, </span>
<span>           <span class="st">"navigating the grocery store without tears: 5/10"</span>,</span>
<span>           <span class="st">"maximizing swing push strength while (mostly) avoiding falls: 7/10"</span><span class="op">)</span></span></code></pre></div>
<p>Now say I want to write a small message and then display the first
<code>n</code> of those skills by decreasing skill order, with
<code>n</code> an arbitrary number. Here’s how it could be done:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/stringmagic/" class="external-link">stringmagic</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="fu">smagic</span><span class="op">(</span><span class="st">"My {&amp;n&gt;1;{N?.} }best skill{#s} with kids:\n"</span>,</span>
<span>        <span class="st">"{'^\\D+'dsort, `n`first, ' - 'paste, '\n'c ? skills}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "My three best skills with kids:\n - being OK with cooking stuff they don't eat: 9/10\n - managing to lose at chance-based board games: 8/10\n - maximizing swing push strength while (mostly) avoiding falls: 7/10"</span></span>
<span></span>
<span><span class="co"># with another number</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu">smagic</span><span class="op">(</span><span class="st">"My {&amp;n&gt;1;{N?.} }best skill{#s} with kids:\n"</span>,</span>
<span>        <span class="st">"{'^\\D+'dsort, `n`first, ' - 'paste, '\n'c ? skills}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "My best skill with kids:\n - being OK with cooking stuff they don't eat: 9/10"</span></span></code></pre></div>
<p>To understand how this works, please have a look at the <a href="https://lrberge.github.io/stringmagic/articles/smagic_walkthrough.html" class="external-link">dedicated
vignette</a>.</p>
<p>Even if it looks esoteric at first sight, writing this kind of
dynamic messages is very common, especially when developping
packages.</p>
<p><strong>Tip:</strong> One way to figure out the value added of
<code>smagic</code> is trying to write this (seemingly simple) message
with alternative tools.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-string-tools">Other string tools<a class="anchor" aria-label="anchor" href="#other-string-tools"></a>
</h2>
<p>On top of <code>smagic</code>, this package offers a few functions
providing new ways to tackle old problems:</p>
<ul>
<li>
<a href="#fun_clean">how to</a> efficiently <strong>and</strong>
<em>explicitly</em> perform manifold string cleaning operations</li>
<li>
<a href="#fun_detect">how to</a> detect the presence of several
regular expressions at once</li>
<li>
<a href="#fun_chain">how to</a> chain basic string operations
without exploding the number of lines of code</li>
</ul>
<p>Here we provide an overview, for more information, see the <a href="https://lrberge.github.io/stringmagic/articles/string_tools.html" class="external-link">associated
vignette</a>.</p>
<div class="section level3">
<h3 id="fun_clean">Cleaning text: Quick and easy please<a class="anchor" aria-label="anchor" href="#fun_clean"></a>
</h3>
<p>One common (and tedious) task in data sciencce is <em>cleaning</em>
character strings. The function <code>str_clean</code> is specialized in
cleaning and has a dedicated syntax:</p>
<ul>
<li>use <code>"pat1, pat2 =&gt; r"</code> to replace the regex patterns
<code>pat1</code> and <code>pat2</code> with the value
<code>r</code>.</li>
<li>use <code>"@op1, op2"</code> to use <code>smagic</code>
operations.</li>
</ul>
<p>To illustrate this function, since real data science problems are a
tiny bit dull, allow me to use a French classic:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tragedy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P: Grâces au ciel, mes mains ne sont point criminelles."</span>,</span>
<span>            <span class="st">"Plût aux dieux que mon coeur fût innocent comme elles !"</span>, </span>
<span>            <span class="st">"..."</span>,</span>
<span>            <span class="st">"P: Quel fruit espères-tu de tant de violence ?"</span>,</span>
<span>            <span class="st">"Tu frémiras d'horreur si je romps le silence."</span>,</span>
<span>            <span class="st">"O: Et que me direz-vous, qui ne cède, grands dieux !"</span>,</span>
<span>            <span class="st">"À l'horreur de vous voir expirer à mes yeux ?"</span>,</span>
<span>            <span class="st">"P: Quand tu sauras mon crime, et le sort qui m'accable,"</span>,</span>
<span>            <span class="st">"Je n'en mourrai pas moins, j'en mourrai plus coupable."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cleaning a text</span></span>
<span><span class="fu"><a href="../reference/str_clean.html">str_clean</a></span><span class="op">(</span><span class="va">tragedy</span>, </span>
<span>          <span class="co"># use smagic to: turn to ascii with transliteration, lower the case</span></span>
<span>          <span class="co"># remove the punctuation + isolated letters + normalize the whitespaces, </span></span>
<span>          <span class="co"># remove empty strings</span></span>
<span>          <span class="st">"@ascii, lower, ws.punct.isolated, rm"</span>,</span>
<span>          <span class="co"># remove a few French stopwords (I use the 'word' flag with w/)</span></span>
<span>          <span class="st">"w/au, aux, mes?, que, mon, comme, elles?, quel, tu, de, si, je, le, et, qui, en"</span>,</span>
<span>          <span class="co"># manually stem some verbs</span></span>
<span>          <span class="st">"fremiras =&gt; fremir"</span>, <span class="st">"w/sont, fut =&gt; etre"</span>, <span class="st">"w/plut =&gt; plaire"</span>, <span class="st">"mourrai =&gt; mourir"</span>,</span>
<span>          <span class="co"># still stemming, note that you can use regex groupings as usual</span></span>
<span>          <span class="st">"romps =&gt; rompre"</span>, <span class="st">"sauras =&gt; savoir"</span>, <span class="st">"\\b(accable|cede|espere)s? =&gt; \\1r"</span>,</span>
<span>          <span class="co"># renormalizing the whitespaces</span></span>
<span>          <span class="st">"@ws"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: In str_to_ascii(x, options):</span></span>
<span><span class="co">#&gt;  When transforming to ASCII, there were 2 failed encodings. Attribute</span></span>
<span><span class="co">#&gt; `isFailed` is created (note that you can only access it if the variable</span></span>
<span><span class="co">#&gt; is not transformed).</span></span>
<span><span class="co">#&gt; (Ignore this message with the `silent` option [ex: `ascii.silent`]. Pass</span></span>
<span><span class="co">#&gt; the native encoding as an option?)</span></span>
<span><span class="co">#&gt; [1] "graces ciel mains ne etre point criminelles"</span></span>
<span><span class="co">#&gt; [2] "plaire dieux coeur etre innocent"           </span></span>
<span><span class="co">#&gt; [3] "fruit esperer tant violence"                </span></span>
<span><span class="co">#&gt; [4] "fremir horreur rompre silence"              </span></span>
<span><span class="co">#&gt; [5] "direz vous ne ceder grands dieux"           </span></span>
<span><span class="co">#&gt; [6] "horreur vous voir expirer yeux"             </span></span>
<span><span class="co">#&gt; [7] "quand savoir crime sort accabler"           </span></span>
<span><span class="co">#&gt; [8] "mourir pas moins mourir plus coupable"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fun_detect">Fast character string detection<a class="anchor" aria-label="anchor" href="#fun_detect"></a>
</h3>
<p>When you want to detect a single pattern in a string,
<code><a href="https://rdrr.io/r/base/grep.html" class="external-link">base::grepl</a></code> or <code><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">stringr::str_detect</a></code> works
pretty well. You feed a regex, and done. But what if you want to detect
the presence, at the same time, of two distinct regular expressions.
This quickly becomes messier (try to get the examples below with a
single <code>grepl</code> call!).</p>
<p>For pattern detection, <code>stringmagic</code> offers three
functions: <code>str_is</code>, <code>str_which</code> and
<code>str_get</code>. Their syntax is as follows:
<code>"pat1 &amp; !pat2 | pat3"</code> with <code>patx</code> a regular
expression. This example means: find the elements that: contain
<code>pat1</code> and do not contain <code>pat2</code>, or contain
<code>pat3</code>. See the examples below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co"># Looking at the cars</span></span>
<span><span class="fu">smagic</span><span class="op">(</span><span class="st">"Cars from the `mtcars` data set:\n{sort, C, 80 width ? cars}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cars from the `mtcars` data set:\nAMC Javelin, Cadillac Fleetwood, Camaro Z28, Chrysler Imperial, Datsun 710,\nDodge Challenger, Duster 360, Ferrari Dino, Fiat 128, Fiat X1-9, Ford Pantera L,\nHonda Civic, Hornet 4 Drive, Hornet Sportabout, Lincoln Continental, Lotus\nEuropa, Maserati Bora, Mazda RX4, Mazda RX4 Wag, Merc 230, Merc 240D, Merc 280,\nMerc 280C, Merc 450SE, Merc 450SL, Merc 450SLC, Pontiac Firebird, Porsche 914-2,\nToyota Corolla, Toyota Corona, Valiant and Volvo 142E."</span></span>
<span></span>
<span><span class="co"># cars containing 'a', 'e', 'i' and 'o'</span></span>
<span><span class="fu"><a href="../reference/str_get.html">str_get</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"a &amp; e &amp; i &amp; o"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cadillac Fleetwood"  "Lincoln Continental" "Pontiac Firebird"   </span></span>
<span><span class="co">#&gt; [4] "Ferrari Dino"        "Maserati Bora"</span></span>
<span></span>
<span><span class="co"># in interactive mode, str_get keeps the previous item in memory, </span></span>
<span><span class="co"># so you can avoid providing the first argument</span></span>
<span></span>
<span><span class="co"># cars not containing any digit nor the letter 'e'</span></span>
<span><span class="fu"><a href="../reference/str_get.html">str_get</a></span><span class="op">(</span><span class="st">"!\\d &amp; !e"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Valiant"        "Honda Civic"    "Toyota Corolla" "Toyota Corona" </span></span>
<span><span class="co">#&gt; [5] "Lotus Europa"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fun_chain">Chaining string operations<a class="anchor" aria-label="anchor" href="#fun_chain"></a>
</h3>
<p>If you want to apply a sequence of operations to a single character
vector, you can use <code>str_ops</code>. It has access to all
operations available to <code>smagic</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co"># Looking at the cars</span></span>
<span><span class="fu">smagic</span><span class="op">(</span><span class="st">"Cars from the `mtcars` data set:\n{sort, C, 80 width ? cars}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Cars from the `mtcars` data set:\nAMC Javelin, Cadillac Fleetwood, Camaro Z28, Chrysler Imperial, Datsun 710,\nDodge Challenger, Duster 360, Ferrari Dino, Fiat 128, Fiat X1-9, Ford Pantera L,\nHonda Civic, Hornet 4 Drive, Hornet Sportabout, Lincoln Continental, Lotus\nEuropa, Maserati Bora, Mazda RX4, Mazda RX4 Wag, Merc 230, Merc 240D, Merc 280,\nMerc 280C, Merc 450SE, Merc 450SL, Merc 450SLC, Pontiac Firebird, Porsche 914-2,\nToyota Corolla, Toyota Corona, Valiant and Volvo 142E."</span></span>
<span></span>
<span><span class="co"># let's get the brands starting with an "m"</span></span>
<span><span class="fu"><a href="../reference/str_ops.html">str_ops</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"'i/^m'get, x, unik"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Mazda"    "Merc"     "Maserati"</span></span>
<span></span>
<span><span class="co"># let's get the 3 largest numbers appearing in the car models</span></span>
<span><span class="fu"><a href="../reference/str_ops.html">str_ops</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"'\\d+'x, rm, unik, num, dsort, 3 first"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 914 710 450</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent R Berge.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
