<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`string_magic`: Magical String Interpolation • stringmagic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`string_magic`: Magical String Interpolation">
<meta property="og:description" content="stringmagic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stringmagic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Guides</li>
    <li>
      <a href="../articles/guide_string_magic.html">`string_magic`: Magical String Interpolation</a>
    </li>
    <li>
      <a href="../articles/guide_string_tools.html">String tools: magic edition</a>
    </li>
    <li>
      <a href="../articles/guide_customization.html">Tailor-made functions and operations</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">References</li>
    <li>
      <a href="../articles/ref_operations.html">`string_magic`'s operations: The reference</a>
    </li>
    <li>
      <a href="../articles/ref_string_magic_special_operations.html">`string_magic`'s sepcial operations</a>
    </li>
    <li>
      <a href="../articles/ref_regex_flags.html">Regular expression flags</a>
    </li>
    <li>
      <a href="../articles/ref_regex_logic.html">Regular expression logic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lrberge/stringmagic/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>string_magic</code>: Magical String
Interpolation</h1>
                        <h4 data-toc-skip class="author">Laurent R.
Bergé</h4>
            
            <h4 data-toc-skip class="date">2024-04-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lrberge/stringmagic/blob/HEAD/vignettes/guide_string_magic.rmd" class="external-link"><code>vignettes/guide_string_magic.rmd</code></a></small>
      <div class="hidden name"><code>guide_string_magic.rmd</code></div>

    </div>

    
    
<p>String interpolation is a common feature of many programming
languages and is used to insert the value of variables directly into
character strings. This is useful to compose dynamic messages in a
natural way. For example <code>"Hello {x}"</code> will be interpolated
as “Hello John” if <code>x = "John"</code>.</p>
<p>What if you want to apply some modifications to the variable before
insertion? Like normalizing the case, trimming at 40 characters, or
concatenating? In general, you can’t. Well, actually you can but have to
use the language’s own native tools. And it can be surprising how
performing a few basic operations can quickly amount to lot of
typing.</p>
<p>The aim of the package <code>stringmagic</code> is to simplify and
empower string interpolation. With the <code>string_magic</code>
function, you can apply 50+ basic operations to interpolated variables,
interpolations can be nested, there is advanced support for
pluralization, and much more.</p>
<div class="section level2">
<h2 id="sec_basic">Basic interpolation<a class="anchor" aria-label="anchor" href="#sec_basic"></a>
</h2>
<p><code>string_magic</code> behaves in a similar way to the well known
function <a href="https://glue.tidyverse.org/" class="external-link">glue</a>. Almost anything
<code>glue</code> can do, <code>string_magic</code> can do. Use curly
brackets to interpolate variables: i.e to insert their value directly in
the string:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/stringmagic/" class="external-link">stringmagic</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="st">"John"</span> ; <span class="va">y</span> <span class="op">=</span> <span class="st">"Mary"</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Hi {x}! How's {y} doing?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hi John! How's Mary doing?"</span></span></code></pre></div>
<p>You can either interpolate a variable that already exists, as above,
or provide the variable as an argument:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Hi {x}! How's {y} doing?"</span>, y <span class="op">=</span> <span class="st">"Jane"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hi John! How's Jane doing?"</span></span></code></pre></div>
<p>So far, so good. Now let’s come to <code>string_magic</code>’s
originality: the ability to add operations to interpolations.</p>
</div>
<div class="section level2">
<h2 id="sec_interpol">How to add operations to interpolations<a class="anchor" aria-label="anchor" href="#sec_interpol"></a>
</h2>
<p>In <code>string_magic</code> you can apply any arbitrary chain of
operations to the interpolated variables. The syntax is as follows:</p>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/operation-template.png"></p>
<p>The <code>operations</code> are a comma separated sequence of
keywords, each keyword being bound to a specific function. Here is an
example in which we apply two operations:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lovers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"romeo"</span>, <span class="st">"juliet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Famous lovers: {title, enum ? lovers}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Famous lovers: Romeo and Juliet."</span></span></code></pre></div>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/example-simple_operation.png"></p>
<p>As shown, <code>title</code> puts to title case and <code>enum</code>
creates an enumeration (i.e. turns the elements of a vector into a
single character string). These two operations are applied sequentially
from left to right to the variable <code>lovers</code>. You can stack as
many operations as you wish.</p>
<p>Here is a short list of common operations: <code>enum</code> to
enumerate; <code>lower</code>, <code>upper</code> and <code>title</code>
to change the case; <code>unik</code> to create the vector of unique
elements; <code>n</code>, <code>N</code> to format integers;
<code>split</code> to break the string with respect to a pattern;
<code>replace</code> to make pattern replacements; <code>collapse</code>
to concatenate the strings; <code>first</code> to select the first
elements; <code>q</code>, <code>Q</code> and <code>bq</code> for
quoting; <code>align</code> to align the elements.</p>
<p>The question mark defines the separation between the operations and
the expression. After the question mark, you can use any valid R
expression. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"The max of each variable is: {enum ? sapply(iris[, 1:4], max)}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The max of each variable is: 7.9, 4.4, 6.9 and 2.5."</span></span></code></pre></div>
<div class="section level3">
<h3 id="adding-arguments-to-operations">Adding arguments to operations<a class="anchor" aria-label="anchor" href="#adding-arguments-to-operations"></a>
</h3>
<p>Many operations use arguments. Arguments are passed using quoted text
just before the operation. The syntax is:</p>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/argument.png"></p>
<p>Let’s take the example of splitting an email address and keeping the
text before the domain:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">email</span> <span class="op">=</span> <span class="st">"John@Doe.com"</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"This message comes from {'@'split, first ? email}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This message comes from John."</span></span></code></pre></div>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/example-argument.png"></p>
<p>In this example, <code>split</code> breaks
<code>"John@Doe.com"</code> with respect to <code>"@"</code>, then
<code>first</code> keeps only the first element. Almost all operations
have default values. For <code>split</code>, the default value is a
single space. The operation <code>first</code> also accepts arguments
and its default is 1. Let’s change it to keep the first two values:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"The first two species are: {unik, '2'first, q, enum ? iris$Species}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The first two species are: 'setosa' and 'versicolor'."</span></span></code></pre></div>
<div class="section level4">
<h4 id="alternative-ways-to-pass-arguments">Alternative ways to pass arguments<a class="anchor" aria-label="anchor" href="#alternative-ways-to-pass-arguments"></a>
</h4>
<p>There are three ways to pass arguments to operations: <img src="images/passing-arguments.png"></p>
<p>The first, canonical way, is using quotes like in the examples of the
previous section.</p>
<p>The second way uses a space to separate the argument from the
operation and hence forbids any space in the argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"The first five sepal lengths are: {5 first, enum ? iris$Sepal.Length}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The first five sepal lengths are: 5.1, 4.9, 4.7, 4.6 and 5."</span></span></code></pre></div>
<p>The third way uses backticks. Passing arguments with backticks
requests an evaluation of the argument, using the variables defined in
the calling environment. Let’s redo the previous example with argument
evaluation:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"The first {N?n} sepal lengths are: {`n`first, enum ? iris$Sepal.Length}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The first five sepal lengths are: 5.1, 4.9, 4.7, 4.6 and 5."</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="adding-options-to-operations">Adding options to operations<a class="anchor" aria-label="anchor" href="#adding-options-to-operations"></a>
</h3>
<p>Options are keywords working like flags (i.e. things that can be
turned on) and change the behavior of the current operation. Many
operations acccept options. Add options using a dot separated sequence
of keywords attached to the operation:</p>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/options.png"></p>
<p>We have seen the <code>enum</code> operation in an earlier example,
let’s add a couple of options to it.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fields</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"maths"</span>, <span class="st">"physics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"This position requires a PhD in either: {enum.i.or ? fields}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "This position requires a PhD in either: i) maths, or ii) physics."</span></span></code></pre></div>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/example-options.png"></p>
<p>As just seen, the option <code>i</code> triggers an enumeration with
roman lower case numbers, and option <code>or</code> finishes the
enumeration with an <code>or</code> instead of an <code>and</code>. The
order of the options does not matter. Note that there is partial
matching on the options, so that long option names can be shortened.</p>
<p>Let’s have another example where we wish to add upper cases but only
for the first letter of each sentence. To do this, we use the option
<code>sentence</code> of the operation <code>upper</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oversight</span> <span class="op">=</span> <span class="st">"hey, you forgot. forgot what? forgot the capital letters!"</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"{upper.sentence ? oversight}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hey, you forgot. Forgot what? Forgot the capital letters!"</span></span></code></pre></div>
<p><strong>Wrapping up.</strong> With <code>string_magic</code> you can
perform string interpolations <em>à la</em> <code>glue</code> and also
empower these interpolations by adding operations on-the-fly (see the <a href="https://lrberge.github.io/stringmagic/articles/ref_operations.html" class="external-link">operations
reference</a>). This can take us a long way already. We are presenting
next how you can nest interpolations and follow with an introduction to
pluralization.</p>
</div>
</div>
<div class="section level2">
<h2 id="nesting-interpolations">Nesting interpolations<a class="anchor" aria-label="anchor" href="#nesting-interpolations"></a>
</h2>
<p>In <code>string_magic</code>, you have two types of interpolations:
regular interpolations (the ones we have covered so far), and verbatim
evaluation. The syntax of vertatim interpolations is as follows:</p>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/verbatim.png"></p>
<p>Anything after the exclamation mark is treated as verbatim:
i.e. anything coming before the closing bracket is treated as a simple
character string. Let’s give an example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Hello {upper ! world}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello WORLD."</span></span></code></pre></div>
<p>In that case, since <code>world</code> is placed after the
excalamation mark (and not a question mark!), the character string
<code>"world"</code> is passed to the operation <code>upper</code>,
leading to the result.</p>
<p>The main interest of verbatim evaluations is nesting. Indeed, the
function <code>string_magic</code> is always applied to the verbatim
character string <em>before</em> any operation is applied. This means
that interpolations within the verbatim text will be resolved. For
example, let’s create the sum from <code>x1</code> to
<code>x3</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"y = {' + 'collapse ! x{1:3}}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "y = x1 + x2 + x3"</span></span></code></pre></div>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/example-verbatim.png"></p>
<p>Now let’s tackle a more challenging example: write a polynomial of
order <code>n</code>. It should be of the form
<code>a + bx + cx^2 + etc</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"poly({n}): {' + 'collapse ! {letters[1 + 0:n]}x^{0:n}}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "poly(2): ax^0 + bx^1 + cx^2"</span></span></code></pre></div>
<p>Let’s break it down. The verbatim expression (the one following the
exclamation mark), here <code>"{letters[1 + 0:n]}x^{0:n}"</code>, is
evaluated with <code>string_magic</code>.
<code>string_magic("{letters[1 + 0:n]}x^{0:n}")</code> leads to the
vector <code>c("ax^0", "bx^1", "cx^2")</code>.</p>
<p>The operation <code>' + 'collapse</code> then concatenates that
vector with <code>' + '</code>. This value is then appended to the
previous string.</p>
<p>We can refine by adding a cleaning operation in which we replace
<code>"x^0"</code> and <code>"^1"</code> by the empty string. Let’s do
it:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"poly({n}): {' + 'c, 'f/x^0, ^1'clean ! {letters[1 + 0:n]}x^{0:n}}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "poly(4): a + bx + cx^2 + dx^3 + ex^4"</span></span></code></pre></div>
<p>To achieve our goal, we used the operation <code>clean</code> which
replaces comma separated regular expression patterns (of the form
<code>'flags/pat1, pat2, etc'</code>) with the empty string. We also
used the flag <code>f</code> (standing for ‘fixed’) to suppress the
regular expression meaning of the patterns (because <code>'^'</code> has
a specific meaning in regexes) – see the <a href="https://lrberge.github.io/stringmagic/articles/ref_regex_flags.html" class="external-link">vignette
on flags</a> for more information. Finally, you can notice that the
operation <code>collapse</code> has a single letter alias.</p>
</div>
<div class="section level2">
<h2 id="pluralization-a-brief-introduction">Pluralization: A brief introduction<a class="anchor" aria-label="anchor" href="#pluralization-a-brief-introduction"></a>
</h2>
<p>Pluralization is about the automatic writing of a message in singular
or plural form, depending on context. This feature is especially
important for developers who often need to write human readable messages
to inform the user. <code>string_magic</code> has an extensive support
for pluralization, which we briefly introduce here.</p>
<p>The syntax for pluralization is as follows:</p>
<p><img src="../../../../../Google%20Drive/R_packages/stringmagic/stringmagic/articles/images/plural.png"></p>
<p>After the opening bracket, to trigger pluralization use an hashtag
(<code>#</code>) or a dollar sign (<code>$</code>) followed by plural
operations. There is two kinds of pluralization: either on the value of
the expresison (the <code>#</code>), either on its length (the
<code>$</code>). Here is an example of pluralization on length with
three operations:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">friends</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Piglet"</span>, <span class="st">"Eeyore"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"My best friend{$s, are, enum ? friends}. Who am I?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "My best friends are Piglet and Eeyore. Who am I?"</span></span>
<span></span>
<span><span class="va">friends</span> <span class="op">=</span> <span class="st">"Mercutio"</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"My best friend{$s, are, enum ? friends}. Who am I?"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "My best friend is Mercutio. Who am I?"</span></span></code></pre></div>
<p>As you can see, the name of the operations is intuitive:
<code>s</code> to add an “s” when plural, <code>are</code> to write
<code>is</code> when singular and <code>are</code> when plural (the
operation <code>is</code> is identical), and <code>enum</code> to create
an enumeration.</p>
<p>Note that in plural interpolations the expression over which to
pluralize is optional. It is automaically deduced from the previous
interpolations. Now let’s illustrate this behavior with a pluralization
on value:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nFiles</span> <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Warning: {N?nFiles} file{#s, is} corrupted."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Warning: six files are corrupted."</span></span>
<span></span>
<span><span class="va">nFiles</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Warning: {N?nFiles} file{#s, is} corrupted."</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Warning: one file is corrupted."</span></span></code></pre></div>
<p>The first interpolation is a regular one. The second one,
<code>{#s, is}</code>, deduces the expression over which to pluralize
from this previous interpolation.</p>
<p>This was only an introduction. To have more information on
pluralization, please see the <a href="https://lrberge.github.io/stringmagic/articles/ref_string_magic_special_operations.html#sec_pluralization" class="external-link">dedicated
section</a>.</p>
</div>
<div class="section level2">
<h2 id="sec_special_cases">Escaping and special cases<a class="anchor" aria-label="anchor" href="#sec_special_cases"></a>
</h2>
<p>We end this introduction with a few special cases.</p>
<div class="section level4">
<h4 id="escape-brackets">Escape brackets<a class="anchor" aria-label="anchor" href="#escape-brackets"></a>
</h4>
<p>The opening and closing brakets, <code><a href="https://rdrr.io/r/base/Paren.html" class="external-link">{}</a></code>, are special
characters and cannot be used as regular text. To bypass their special
meaning, you need to escape them with a double backslash.</p>
<p>You only need to escape the special delimiters which the algorithm is
currently looking for. For example, if we escape the opening delimiter,
we don’t need to escape the closing one:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here opening delimiter is escaped: the closing delimiter has no special meaning</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"open = \\{, close = }"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "open = {, close = }"</span></span></code></pre></div>
<p>You need to escape the closing delimiter only when the algorithm is
looking for it. In the following example, we need to escape the closing
curly bracket to treat it as a regular character:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Here are closing brackets: {5 times.c ! \\}}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Here are closing brackets: }}}}}"</span></span></code></pre></div>
<p>Alternatively, use the argument <code>.delim</code> to change the
delimiters:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Here I {interpolate} with .[this] "</span>, .delim <span class="op">=</span> <span class="st">".[ ]"</span>, this <span class="op">=</span> <span class="st">".[]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Here I {interpolate} with .[] "</span></span></code></pre></div>
<p>When using delimiters composed of two or more characters, like in the
previous example, to escape it you need to add a double backslash before
the first character (i.e. right before the delimiter):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Here I {interpolate} with \\.[] "</span>, .delim <span class="op">=</span> <span class="st">".[ ]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Here I {interpolate} with .[] "</span></span>
<span></span>
<span><span class="co"># another example with {{ }}  as delimiter</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"I {{what}} with \\{{ }} "</span>, .delim <span class="op">=</span> <span class="st">"{{ }}"</span>, what <span class="op">=</span> <span class="st">"interpolate"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "I interpolate with {{ }} "</span></span></code></pre></div>
<p>Another way is to pass a character string in an expression. Indeed,
since <code>{expr}</code> evaluates <code>expr</code>, if
<code>expr</code> is a character string, it will stay untouched.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"I {'can {write} {{what}} I want'}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "I can {write} {{what}} I want"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-escapes">Other escapes<a class="anchor" aria-label="anchor" href="#other-escapes"></a>
</h4>
<p>In the few operations expecting a semi-colon (<em>if-else</em> and
certain operations in <em>pluralization</em>), it can also be escaped
with a double backslash.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if-else statement with semi-colon</span></span>
<span><span class="va">is_c</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"{&amp;is_c ; int i = 1\\; ; i = 1}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "int i = 1;"</span></span>
<span></span>
<span><span class="va">is_c</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"{&amp;is_c ; int i = 1\\; ; i = 1}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "i = 1"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="how-to-use-a-regular-in-interpolations">How to use a regular <code>!</code> in interpolations?<a class="anchor" aria-label="anchor" href="#how-to-use-a-regular-in-interpolations"></a>
</h4>
<p>In interpolations, the exclamation mark (<code>!</code>) signals a
verbatim expression. But what if you use it to mean the logical
operation <em>not</em> in an operation-free interpolation? In that case,
you need a hack: use a question mark (<code>?</code>) first to indicate
to the algorithm that you want to evaluate the expression.</p>
<p>Ex.4: using the <code>?</code> hack to use <code>!</code> as a
logical operation.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"{!TRUE} is {?!TRUE}"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "TRUE is FALSE"</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent R Berge.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
