<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Register custom operations to apply them in string_magic — string_magic_register_fun • stringmagic</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Register custom operations to apply them in string_magic — string_magic_register_fun"><meta property="og:description" content="Extends the capabilities of string_magic() by adding any custom operation"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stringmagic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Guides</li>
    <li>
      <a href="../articles/guide_string_magic.html">`string_magic`: Magical String Interpolation</a>
    </li>
    <li>
      <a href="../articles/guide_string_tools.html">String tools: magic edition</a>
    </li>
    <li>
      <a href="../articles/guide_customization.html">Tailor-made functions and operations</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">References</li>
    <li>
      <a href="../articles/ref_operations.html">`string_magic`'s operations: The reference</a>
    </li>
    <li>
      <a href="../articles/ref_string_magic_special_operations.html">`string_magic`'s sepcial operations</a>
    </li>
    <li>
      <a href="../articles/ref_regex_flags.html">Regular expression flags</a>
    </li>
    <li>
      <a href="../articles/ref_regex_logic.html">Regular expression logic</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lrberge/stringmagic/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Register custom operations to apply them in <code>string_magic</code></h1>
    <small class="dont-index">Source: <a href="https://github.com/lrberge/stringmagic/blob/HEAD/R/string_magic_main.R" class="external-link"><code>R/string_magic_main.R</code></a></small>
    <div class="hidden name"><code>string_magic_register_fun.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extends the capabilities of <code><a href="string_magic.html">string_magic()</a></code> by adding any custom operation</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">string_magic_register_fun</span><span class="op">(</span><span class="va">fun</span>, <span class="va">alias</span>, valid_options <span class="op">=</span> <span class="cn">NULL</span>, namespace <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">string_magic_register_ops</span><span class="op">(</span><span class="va">ops</span>, <span class="va">alias</span>, namespace <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fun</dt>
<dd><p>A function which must have at least the arguments 'x' and '...'.
Additionnaly, it can have the arguments: 'argument', 'options', 'group', 'group_flag'.
This function must return a vector.
This function will be internally called by <code>string_magic</code> in the form
<code>fun(x, argument, options, group, group_flag)</code>.<code>x</code>: the value to which the
operation applies. <code>argument</code>: the quoted <code>string_magic</code> argument (always character).
<code>options</code>: a character vector of <code>string_magic</code> options. The two last arguments are of use
only in group-wise operations if <code>fun</code> changes the lengths of vectors. <code>group</code>: an index of
the group to which belongs each observation (integer). <code>group_flag</code>: value between 0
and 2; 0: no grouping operation requested; 1: keep track of groups; 2: apply grouping.</p></dd>


<dt>alias</dt>
<dd><p>Character scalar, the name of the operation.</p></dd>


<dt>valid_options</dt>
<dd><p>A character vector or NULL (default). Represents a list of
valid options for the operation. This is used: a) to enable auto-completion,
b) for error-handling purposes.</p></dd>


<dt>namespace</dt>
<dd><p>Character scalar or <code>NULL</code> (default). <strong>Only useful for package developers.</strong>
As a regular end-user you shouldn't care! If your package uses <code>string_magic</code>, you should care.
If the function <code>string_magic_register_*</code> is located in the <code>onLoad</code> function (see <code>help("onLoad")</code>),
there is nothing to do. Otherwise, pass the name of your package in this argument to
make all the new operation definitions scoped (i.e. only your package can access it and
it can't be messed up by end users).</p></dd>


<dt>ops</dt>
<dd><p>Character scalar representing a valid chain of <code>string_magic</code> operations. It should
be of the form <code>"op1, 'arg'op2, etc"</code>. For example <code>"'80|-'fill"</code> fills the line
with dashes up to 80 characters.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>These function do not return anything. They register new operations to be used in the
<code>string_magic</code> family of functions by placing them in the options (later fetched by
<code><a href="string_magic.html">string_magic()</a></code> at run-time).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>We try to strongly check the new operations since it's always better to find out problems
sooner than later. This means that when the function is defined, it is also
tested.</p>
<p>If you pass a function, note that it should work for non-character arguments in <code>x</code>.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>string_magic_register_ops()</code>: Create new combinations of <code>string_magic</code> operations</p></li>
</ul></div>
    <div id="writing-a-package-using-string-magic">
    <h2>Writing a package using <code>string_magic</code></h2>
    


<p>If you want to use <code>string_magic</code> in your package and want to make use of custom operations:</p><ul><li><p>place any <code>string_magic_register_fun</code> and <code>string_magic_register_ops</code> in your <code>.onLoad</code> function
(see <code>help("onLoad")</code>). The .onLoad function is run whenever the package is loaded
for the first time. It's a function that you can place anywhere in your <code>R/*</code> files
and which looks like this:</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="va">.onLoad</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">libname</span>, <span class="va">pkgname</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># string_magic custom operations</span></span>
<span>  <span class="fu"><a href="../reference/string_magic_register_fun.html">string_magic_register_ops</a></span><span class="op">(</span><span class="st">"'80|-'fill"</span>, <span class="st">"h1"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre><p></p></div><ul><li><p>if you don't want to place the <code>string_magic_register_*</code> functions in the .onLoad function,
you can, but then you <strong>must</strong> provide the argument <code>namespace</code>:</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/string_magic_register_fun.html">string_magic_register_ops</a></span><span class="op">(</span><span class="st">"'80|-'fill"</span>, <span class="st">"h1"</span>, namespace <span class="op">=</span> <span class="st">"myPackageName"</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>you must create an <code><a href="string_magic_alias.html">string_magic_alias()</a></code> to create an alias to <code><a href="string_magic.html">string_magic()</a></code> and use the
argument <code>.namespace = "myPackageName"</code>. Use this opportunity to change the
defaults if you wish. You can even override the <code>string_magic</code> function:</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="co"># creating an alias with the same name + changing the delimiter</span></span>
<span><span class="va">string_magic</span> <span class="op">=</span> <span class="fu">stringmagic</span><span class="fu">::</span><span class="fu"><a href="../reference/string_magic_alias.html">string_magic_alias</a></span><span class="op">(</span>.namespace <span class="op">=</span> <span class="st">"myPackageName"</span>, .delim <span class="op">=</span> <span class="st">"{{ }}"</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other related to string_magic: 
<code><a href="string_magic_alias.html">string_magic_alias</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Laurent R. Berge</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># let's create an operation that adds markdown emphasis</span></span></span>
<span class="r-in"><span><span class="co"># to elements of a vector</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A) define the function</span></span></span>
<span class="r-in"><span><span class="va">fun_emph</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="va">x</span>, <span class="st">"*"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># B) register it</span></span></span>
<span class="r-in"><span><span class="fu">string_magic_register_fun</span><span class="op">(</span><span class="va">fun_emph</span>, <span class="st">"emph"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># C) use it</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="string_vec.html">string_vec</a></span><span class="op">(</span><span class="st">"right, now"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Take heed, {emph, c? x}."</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Take heed, *right* *now*."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># now let's add the option "strong"</span></span></span>
<span class="r-in"><span><span class="va">fun_emph</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">options</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="st">"strong"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">options</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"***"</span>, <span class="va">x</span>, <span class="st">"***"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="va">x</span>, <span class="st">"*"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">string_magic_register_fun</span><span class="op">(</span><span class="va">fun_emph</span>, <span class="st">"emph"</span>, <span class="st">"strong"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="string_vec.html">string_vec</a></span><span class="op">(</span><span class="st">"right, now"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Take heed, {emph.strong, c? x}."</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Take heed, ***right*** ***now***."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># now let's add an argument</span></span></span>
<span class="r-in"><span><span class="va">fun_emph</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">argument</span>, <span class="va">options</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">arg</span> <span class="op">=</span> <span class="va">argument</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">arg</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">arg</span> <span class="op">=</span> <span class="st">"*"</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="st">"strong"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">options</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">arg</span>, <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">arg</span>, <span class="va">x</span>, <span class="va">arg</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">string_magic_register_fun</span><span class="op">(</span><span class="va">fun_emph</span>, <span class="st">"emph"</span>, <span class="st">"strong"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="string_vec.html">string_vec</a></span><span class="op">(</span><span class="st">"right, now"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="string_magic.html">string_magic</a></span><span class="op">(</span><span class="st">"Take heed, {'_'emph.s, c? x}."</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Take heed, ___right___ ___now___."</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># using string_magic_register_ops</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a 'header' maker</span></span></span>
<span class="r-in"><span><span class="fu">string_magic_register_ops</span><span class="op">(</span><span class="st">"tws, '# 'paste, ' 'paste.right, '40|-'fill"</span>, <span class="st">"h1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="cat_magic.html">cat_magic</a></span><span class="op">(</span><span class="st">"{h1 ! My title}\n my content"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # My title -----------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  my content</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent R Berge.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

